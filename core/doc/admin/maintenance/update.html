<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Upgrading ownCloud with the Updater App &mdash; ownCloud 8.0 Server Administration Manual 8.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/main.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/styles.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '8.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="ownCloud 8.0 Server Administration Manual 8.0 documentation" href="../contents.html" />
    <link rel="up" title="Maintenance" href="index.html" />
    <link rel="next" title="Restoring ownCloud" href="restore.html" />
    <link rel="prev" title="Upgrading Your ownCloud Server" href="upgrade.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="theme-color" content="#1d2d44">

  </head>
  <body role="document">


<div class="wrap container not-front">
  <div class="content row">
  <main class="main">
    <div class="row page-content-header">
      <div class="col-md-5 col-md-offset-7">
      
        <form class="headersearch" style="margin-bottom:-3px;" action="../search.html" method="get">
        <input type="text" value="" name="q" id="q" class="form-control" /> 
        <button  class="btn btn-default" type="submit" id="searchsubmit">Search</button>
        </form>
      
      </div>
    </div>
    
			<div class="row">
				<div class="col-md-3">
					<div class="sidebar">
							<div class="menu-support-container">
								<ul id="menu-support" class="menu">
									<ul>
										
<li><a href="../contents.html">Table of Contents</a></li>
									</ul>
                  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">ownCloud 8.0 Server Administration Manual Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">ownCloud 8.0 Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../whats_new_admin.html">What&#8217;s New for Admins in ownCloud 8</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration_user/index.html">User Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration_files/index.html">File Sharing and Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration_server/index.html">ownCloud Server Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration_database/index.html">Database Configuration</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Maintenance</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="enable_maintenance.html">Maintenance Mode Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="backup.html">Backing up ownCloud</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrade.html">Upgrading Your ownCloud Server</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Upgrading ownCloud with the Updater App</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#can-t-login-without-updating">Can&#8217;t Login Without Updating</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setting-strong-permissions">Setting Strong Permissions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="restore.html">Restoring ownCloud</a></li>
<li class="toctree-l2"><a class="reference internal" href="migrating.html">Migrating to a Different Server</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../operations/index.html">Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../issues/index.html">Issues and Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../videos/index.html">ownCloud Videos</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../enterprise_installation/index.html">Enterprise Edition Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../enterprise_clients/index.html">Creating Branded ownCloud Clients (Enterprise only)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../enterprise_server_branding/index.html">Enterprise Server Branding (Enterprise only)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../enterprise_external_storage/index.html">External Storage (Enterprise only)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../enterprise_user_management/index.html">User Management (Enterprise only)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../enterprise_files_drop/index.html">Enabling Anonymous Uploads with Files Drop (Enterprise Only)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../enterprise_logging/index.html">Enterprise Logging Apps (Enterprise only)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../enterprise_troubleshooting.html">Enterprise Troubleshooting</a></li>
</ul>

								</ul>
							</div>
					</div>
				</div>
        

				<div class="col-md-9">
					<div class="page-content">
            
<ul class="prevnext-title list-unstyled list-inline">
  <li class="prev">
    <a href="upgrade.html" title="Previous Chapter: Upgrading Your ownCloud Server"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm">&laquo; Upgrading You...</span>
    </a>
  </li>
  <li class="next">
    <a href="restore.html" title="Next Chapter: Restoring ownCloud"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm">Restoring own... &raquo;</span>
    </a>
  </li>
</ul>
						
  <div class="section" id="upgrading-owncloud-with-the-updater-app">
<h1>Upgrading ownCloud with the Updater App<a class="headerlink" href="#upgrading-owncloud-with-the-updater-app" title="Permalink to this headline">Â¶</a></h1>
<p>The Updater app automates many of the steps of updating an ownCloud
installation. You should keep your ownCloud server updated and not skip any
releases. The Updater app is enabled in your ownCloud Server instance by
default, which you can confirm by looking on your Apps page.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The Updater app is <strong>not enabled and not supported</strong> in ownCloud
Enterprise edition.</p>
<p>The Updater app is <strong>not included</strong> in the
<a class="reference external" href="https://download.owncloud.org/download/repositories/stable/owncloud/">Linux packages on our Open Build Service</a>,
but only in the <a class="reference external" href="https://owncloud.org/install/#instructions-server">tar and zip archives</a>. When you install
ownCloud from packages you should keep it updated with your package manager.</p>
<p class="last"><strong>Downgrading</strong> is not supported and risks corrupting your data! If you want
to revert to an older ownCloud version, install it from scratch and then
restore your data from backup. Before doing this, file a support ticket (if
you have paid support) or ask for help in the ownCloud forums to see if your
issue can be resolved without downgrading.</p>
</div>
<p>The Updater App is not required, and it is recommended to use other methods for
keeping your ownCloud server up-to-date, if possible. (See <a class="reference internal" href="upgrade.html"><em>Upgrading Your ownCloud Server</em></a>.) The
Updater App is useful for installations that do not have root access,
such as shared hosting, for installations with a smaller number of users
and data, and it automates updating
<a class="reference internal" href="../installation/source_installation.html"><em>manual installations</em></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you are using the Encryption app and upgrading from older
versions of ownCloud to ownCloud 8.0, you must manually migrate your
encryption keys with the <em>occ</em> command after the upgrade is complete, like
this example for CentOS:
<em>sudo -u apache php occ encryption:migrate-keys</em>
You must run <em>occ</em> as your HTTP user. See
<a class="reference internal" href="../configuration_server/occ_command.html"><em>Using the occ Command</em></a> to learn more about <em>occ</em></p>
</div>
<p>You should maintain regular backups (see <a class="reference internal" href="backup.html"><em>Backing up ownCloud</em></a>), and make a backup
before every update. The Updater app does not backup your database or data
directory.</p>
<p>The Updater app performs these operations:</p>
<ul class="simple">
<li>Creates an <code class="docutils literal"><span class="pre">updater_backup</span></code> directory under your ownCloud data directory</li>
<li>Download and extracts updated package content into the
<code class="docutils literal"><span class="pre">updater_backup/packageVersion</span></code> directory</li>
<li>Makes a copy of your current ownCloud instance, except for your data
directory, to  <code class="docutils literal"><span class="pre">updater_backup/currentVersion-randomstring</span></code></li>
<li>Moves all directories except <code class="docutils literal"><span class="pre">data</span></code>, <code class="docutils literal"><span class="pre">config</span></code> and <code class="docutils literal"><span class="pre">themes</span></code> from the
current instance to <code class="docutils literal"><span class="pre">updater_backup/tmp</span></code></li>
<li>Moves all directories from <code class="docutils literal"><span class="pre">updater_backup/packageVersion</span></code> to the current
version</li>
<li>Copies your old <code class="docutils literal"><span class="pre">config.php</span></code> to the new <code class="docutils literal"><span class="pre">config/</span></code> directory</li>
</ul>
<p><strong>Follow these steps in order</strong></p>
<p>Using the Updater app to update your ownCloud installation is just a few
steps:</p>
<ol class="arabic simple">
<li>You should see a notification at the top of any ownCloud page when there is
a new update available:</li>
</ol>
<div class="figure">
<img alt="../_images/updater-1.png" src="../_images/updater-1.png" />
</div>
<ol class="arabic simple" start="2">
<li>Even though the Updater app backs up important directories, you should
always have your own current backups (See <a class="reference internal" href="backup.html"><em>Backing up ownCloud</em></a> for details.)</li>
<li>Verify that the HTTP user on your system can write to your whole ownCloud
directory; see the <a class="reference internal" href="#setting-strong-permissions"><span>Setting Strong Permissions</span></a> section below.</li>
<li>Navigate to your Admin page and click the <cite>Update Center</cite> button under
Updater:</li>
</ol>
<div class="figure">
<img alt="../_images/updater-2.png" src="../_images/updater-2.png" />
</div>
<ol class="arabic simple" start="5">
<li>This takes you to the Updater control panel.</li>
</ol>
<div class="figure">
<img alt="../_images/updater-3.png" src="../_images/updater-3.png" />
</div>
<ol class="arabic simple" start="6">
<li>Click Update, and carefully read the messages. If there are any problems it
will tell you. The most common issue is directory permissions; your HTTP
user needs write permissions to your whole ownCloud directory. (See
<a class="reference internal" href="#setting-strong-permissions"><span>Setting Strong Permissions</span></a>.) Otherwise you will see messages about
checking your installation and making backups.</li>
</ol>
<div class="figure">
<a class="reference internal image-reference" href="../_images/updater-9.png"><img alt="../_images/updater-9.png" src="../_images/updater-9.png" style="width: 439.5px; height: 422.25px;" /></a>
</div>
<ol class="arabic simple" start="7">
<li>Click Proceed, and then it performs the remaining steps, which takes a few
minutes.</li>
</ol>
<div class="figure">
<a class="reference internal image-reference" href="../_images/updater-10.png"><img alt="../_images/updater-10.png" src="../_images/updater-10.png" style="width: 439.5px; height: 432.0px;" /></a>
</div>
<ol class="arabic simple" start="8">
<li>If your directory permissions are correct, a backup was made, and
downloading the new ownCloud archive succeeded you will see the following
screen. Click the Start Update button to complete your update:</li>
</ol>
<div class="figure">
<img alt="../_images/updater-8.png" src="../_images/updater-8.png" />
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>If you have a large ownCloud installation, at this point you
should use the <code class="docutils literal"><span class="pre">occ</span> <span class="pre">upgrade</span></code> command, running it as your HTTP user,
instead of clicking the Start Update button, in order to avoid PHP
timeouts. This example is for Ubuntu Linux:</p>
<div class="last highlight-python"><div class="highlight"><pre>$ sudo -u www-data php occ upgrade
</pre></div>
</div>
</div>
<p>Before completing the upgrade, ownCloud first runs a simulation by copying all
database tables to new tables, and then performs the upgrade on them, to ensure
that the upgrade will complete correctly. The copied tables are deleted after
the upgrade. This takes twice as much time, which on large installations can be
many hours, so you can omit this step with the <code class="docutils literal"><span class="pre">--skip-migration-test</span></code>
option, like this example on Ubuntu:</p>
<div class="highlight-python"><div class="highlight"><pre>$ sudo -u www-data php occ upgrade --skip-migration-test
</pre></div>
</div>
<p>See <a class="reference internal" href="../configuration_server/occ_command.html"><em>Using the occ Command</em></a> to learn more.</p>
<ol class="arabic simple" start="9">
<li>It runs for a few minutes, and when it is finished displays a success
message, which disappears after a short time.</li>
</ol>
<div class="figure">
<img alt="../_images/updater-7.png" src="../_images/updater-7.png" />
</div>
<p>Refresh your Admin page to verify your new version number. In the Updater
section of your Admin page you can see the current status and backups. These
are backups of your old and new ownCloud installations, and do not contain your
data files. If your update works and there are no problems you can delete the
backups from this screen.</p>
<div class="figure">
<a class="reference internal image-reference" href="../_images/updater-11.png"><img alt="../_images/updater-11.png" src="../_images/updater-11.png" style="width: 431.25px; height: 381.75px;" /></a>
</div>
<p>If the update fails, then you must update manually. (See <a class="reference internal" href="upgrade.html"><em>Upgrading Your ownCloud Server</em></a>.)</p>
<div class="section" id="can-t-login-without-updating">
<h2>Can&#8217;t Login Without Updating<a class="headerlink" href="#can-t-login-without-updating" title="Permalink to this headline">Â¶</a></h2>
<p>If you can&#8217;t login to your ownCloud installation without performing an update
first, this means that updated ownCloud files have already been downloaded to
your server, most likely via your Linux package manager during a routine system
update. So you only need to click the Start Update button, or run the <code class="docutils literal"><span class="pre">occ</span></code>
command to complete the update.</p>
</div>
<div class="section" id="setting-strong-permissions">
<span id="id1"></span><h2>Setting Strong Permissions<a class="headerlink" href="#setting-strong-permissions" title="Permalink to this headline">Â¶</a></h2>
<p>For hardened security we  highly recommend setting the permissions on your
ownCloud directory as strictly as possible. These commands should be executed
immediately after the initial installation. Please follow the steps in the
<strong>Setting Strong Directory Permissions</strong> section of
<a class="reference internal" href="../installation/installation_wizard.html"><em>Installation Wizard</em></a>.</p>
<p>These strict permissions will prevent the Updater app from working, as it needs
your whole ownCloud directory to be owned by the HTTP user. The generic command
to change ownership of all files and subdirectories in a directory to the HTTP
user is:</p>
<div class="highlight-python"><div class="highlight"><pre>chown -R &lt;http-user&gt;:&lt;http-user&gt; /path/to/owncloud/
</pre></div>
</div>
<ul>
<li><p class="first">This example is for Ubuntu 14.04 LTS server:</p>
<div class="highlight-python"><div class="highlight"><pre>chown -R www-data:www-data /var/www/owncloud
</pre></div>
</div>
</li>
<li><p class="first">Arch Linux:</p>
<div class="highlight-python"><div class="highlight"><pre>chown -R http:http /path/to/owncloud/
</pre></div>
</div>
</li>
<li><p class="first">Fedora:</p>
<div class="highlight-python"><div class="highlight"><pre>chown -R apache:apache /path/to/owncloud/
</pre></div>
</div>
</li>
<li><p class="first">openSUSE:</p>
<div class="highlight-python"><div class="highlight"><pre>chown -R wwwrun:www /path/to/owncloud/
</pre></div>
</div>
</li>
</ul>
<p>After the Updater app has run, you should re-apply the strict permissions.</p>
</div>
</div>


            
<ul class="prevnext-title list-unstyled list-inline">
  <li class="prev">
    <a href="upgrade.html" title="Previous Chapter: Upgrading Your ownCloud Server"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm">&laquo; Upgrading You...</span>
    </a>
  </li>
  <li class="next">
    <a href="restore.html" title="Next Chapter: Restoring ownCloud"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm">Restoring own... &raquo;</span>
    </a>
  </li>
</ul>
					</div>
				</div>
			</div>
  </main>  
  </div>
</div>
  </body>
</html>